
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="TypixClin - Connexion et inscription">
<title>Connexion - TypixClin</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<!-- EmailJS SDK -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

<style>
:root {
    --primary: #3b82f6;
    --primary-dark: #1d4ed8;
    --primary-light: #60a5fa;
    --primary-gradient: linear-gradient(135deg, #3b82f6, #2563eb);
    --secondary: #475569;
    --accent: #8b5cf6;
    --background: #f5f8ff;
    --white: #ffffff;
    --black: #111827;
    --gray-50: #f9fafb;
    --gray-100: #f3f4f6;
    --gray-200: #e5e7eb;
    --gray-300: #d1d5db;
    --gray-400: #9ca3af;
    --gray-500: #6b7280;
    --gray-600: #4b5563;
    --gray-700: #374151;
    --gray-800: #1f2937;
    --gray-900: #111827;
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    --shadow-blue: 0 10px 25px -5px rgba(59, 130, 246, 0.5);
    --shadow-blue-lg: 0 20px 30px -10px rgba(59, 130, 246, 0.6);
    --header-height: 70px;
    --container-max-width: 1280px;
    --border-radius-sm: 0.375rem;
    --border-radius-md: 0.5rem;
    --border-radius-lg: 1rem;
    --border-radius-xl: 1.5rem;
    --border-radius-full: 9999px;
    --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-normal: 300ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: 500ms cubic-bezier(0.4, 0, 0.2, 1);
    --font-display: 'Outfit', sans-serif;
    --font-body: 'Space Grotesk', sans-serif;
    --z-elevated: 10;
    --z-sticky: 100;
    --z-max: 9999;
}

[data-theme="dark"] {
    --primary: #60a5fa;
    --primary-dark: #3b82f6;
    --primary-light: #93c5fd;
    --primary-gradient: linear-gradient(135deg, #60a5fa, #3b82f6);
    --background: #0f172a;
    --white: #1e293b;
    --black: #f9fafb;
    --gray-900: #f9fafb;
    --gray-800: #f3f4f6;
    --gray-700: #e5e7eb;
    --gray-600: #d1d5db;
    --gray-500: #9ca3af;
    --gray-400: #6b7280;
    --gray-300: #4b5563;
    --gray-200: #374151;
    --gray-100: #1f2937;
    --gray-50: #111827;
    --shadow-blue: 0 10px 25px -5px rgba(96, 165, 250, 0.3);
}

*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
html { font-size: 16px; scroll-behavior: smooth; scrollbar-width: thin; scrollbar-color: var(--primary) var(--background); }
body { font-family: var(--font-body); background-color: var(--background); color: var(--gray-800); line-height: 1.6; min-height: 100vh; overflow-x: hidden; transition: background-color var(--transition-normal), color var(--transition-normal); }
h1, h2, h3, h4, h5, h6 { font-family: var(--font-display); font-weight: 700; line-height: 1.2; color: var(--gray-900); transition: color var(--transition-normal); }
a { text-decoration: none; color: var(--primary); transition: color var(--transition-normal); }
button { cursor: pointer; font-family: var(--font-body); border: none; background: none; transition: all var(--transition-normal); }
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track { background: var(--background); }
::-webkit-scrollbar-thumb { background: var(--primary); border-radius: var(--border-radius-full); }
.container { width: 100%; max-width: var(--container-max-width); margin: 0 auto; padding: 0 1.5rem; }

@keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
@keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
@keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); } 20%, 40%, 60%, 80% { transform: translateX(5px); } }
@keyframes checkmark { 0% { transform: scale(0); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
@keyframes spin { to { transform: rotate(360deg); } }

.header { position: fixed; top: 0; left: 0; width: 100%; height: var(--header-height); z-index: var(--z-sticky); transition: transform var(--transition-normal), background-color var(--transition-normal), box-shadow var(--transition-normal); background-color: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); }
[data-theme="dark"] .header { background-color: rgba(30, 41, 59, 0.9); }
.header.scrolled { box-shadow: var(--shadow-md); }
.header-container { height: 100%; display: flex; justify-content: space-between; align-items: center; }
.logo { font-family: var(--font-display); font-size: 1.8rem; font-weight: 800; color: var(--primary); letter-spacing: -0.05em; display: flex; align-items: center; gap: 0.5rem; }
.logo-icon { display: inline-flex; align-items: center; justify-content: center; width: 2.5rem; height: 2.5rem; background: var(--primary-gradient); border-radius: var(--border-radius-md); color: white; font-size: 1.5rem; }
.logo:hover .logo-icon { animation: pulse 1s infinite; }
.nav { display: flex; align-items: center; }
.nav-items { display: flex; list-style: none; gap: 2rem; }
.nav-link { font-weight: 500; color: var(--gray-700); transition: color var(--transition-normal), transform var(--transition-normal); position: relative; }
.nav-link::after { content: ''; position: absolute; bottom: -4px; left: 0; width: 0; height: 2px; background: var(--primary-gradient); transition: width var(--transition-normal); }
.nav-link:hover { color: var(--primary); transform: translateY(-2px); }
.nav-link:hover::after { width: 100%; }
.theme-toggle { display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; background: var(--gray-100); border-radius: var(--border-radius-full); color: var(--gray-600); font-size: 1.25rem; cursor: pointer; margin-left: 2rem; transition: all var(--transition-normal); }
[data-theme="dark"] .theme-toggle { background: var(--gray-800); color: var(--gray-300); }
.theme-toggle:hover { background: var(--primary-light); color: white; transform: rotate(15deg); }
.mobile-menu-btn { display: none; font-size: 1.5rem; color: var(--gray-700); transition: color var(--transition-normal); }
.mobile-menu-btn:hover { color: var(--primary); }

@media (max-width: 992px) {
    .nav-items { display: none; }
    .mobile-menu-btn { display: block; }
    .theme-toggle { margin-left: 1.5rem; margin-right: 0.5rem; }
}

.mobile-menu { position: fixed; top: var(--header-height); left: 0; width: 100%; background-color: var(--white); padding: 2rem; z-index: calc(var(--z-sticky) - 1); box-shadow: var(--shadow-lg); transform: translateY(-100%); opacity: 0; visibility: hidden; transition: transform var(--transition-normal), opacity var(--transition-normal), visibility var(--transition-normal); display: flex; flex-direction: column; gap: 1.5rem; }
.mobile-menu.active { transform: translateY(0); opacity: 1; visibility: visible; }
.mobile-menu .nav-link { font-size: 1.25rem; display: block; padding: 0.75rem 0; border-bottom: 1px solid var(--gray-200); }

.page-header { padding-top: calc(var(--header-height) + 3rem); padding-bottom: 2rem; background: linear-gradient(135deg, rgba(239, 246, 255, 0.8) 0%, rgba(219, 234, 254, 0.8) 100%); text-align: center; }
[data-theme="dark"] .page-header { background: linear-gradient(135deg, rgba(17, 24, 39, 0.8) 0%, rgba(31, 41, 55, 0.8) 100%); }
.page-title { font-size: 2.5rem; font-weight: 800; background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.75rem; animation: fadeInUp var(--transition-slow) forwards; }
.page-subtitle { font-size: 1rem; color: var(--gray-600); max-width: 500px; margin: 0 auto 1.5rem; }
.back-home-btn { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1.5rem; background: var(--primary-gradient); color: white; font-weight: 600; font-size: 0.95rem; border-radius: var(--border-radius-full); box-shadow: var(--shadow-md); transition: all var(--transition-normal); }
.back-home-btn:hover { transform: translateY(-3px); box-shadow: var(--shadow-blue); color: white; }

.main-content { padding: 3rem 1.5rem; display: flex; justify-content: center; position: relative; }
.main-content::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%233b82f6' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"); opacity: 0.5; z-index: -1; }

.auth-card { background: var(--white); border-radius: var(--border-radius-xl); box-shadow: var(--shadow-xl); padding: 2.5rem; width: 100%; max-width: 420px; border: 1px solid var(--gray-200); animation: fadeInUp var(--transition-slow) forwards; position: relative; overflow: hidden; }
.auth-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: var(--primary-gradient); }
.auth-header { text-align: center; margin-bottom: 1.5rem; }
.auth-icon { width: 60px; height: 60px; background: var(--primary-gradient); border-radius: var(--border-radius-lg); display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; font-size: 1.75rem; color: white; box-shadow: var(--shadow-blue); }
.auth-title { font-family: var(--font-display); font-size: 1.75rem; font-weight: 800; color: var(--gray-900); margin-bottom: 0.25rem; }
.auth-subtitle { color: var(--gray-500); font-size: 0.95rem; }

.auth-tabs { display: flex; background: var(--gray-100); border-radius: var(--border-radius-full); padding: 0.25rem; margin-bottom: 1.5rem; }
.tab-btn { flex: 1; padding: 0.7rem 1rem; border: none; background: transparent; font-family: var(--font-body); font-size: 0.95rem; font-weight: 600; color: var(--gray-500); border-radius: var(--border-radius-full); cursor: pointer; transition: all var(--transition-normal); }
.tab-btn.active { background: var(--white); color: var(--primary); box-shadow: var(--shadow-md); }
.tab-btn:hover:not(.active) { color: var(--gray-700); }

.auth-form { display: none; }
.auth-form.active { display: block; animation: fadeInUp var(--transition-normal) forwards; }
.form-group { margin-bottom: 1.25rem; }
.form-label { display: block; font-weight: 600; color: var(--gray-700); margin-bottom: 0.5rem; font-size: 0.9rem; }
.input-wrapper { position: relative; display: flex; align-items: center; }
.input-wrapper .input-icon { position: absolute; left: 1rem; color: var(--gray-400); transition: color var(--transition-normal); pointer-events: none; font-size: 1rem; }
.form-input { width: 100%; padding: 0.85rem 3rem 0.85rem 2.75rem; border: 2px solid var(--gray-200); border-radius: var(--border-radius-lg); font-family: var(--font-body); font-size: 1rem; color: var(--gray-800); background: var(--white); transition: all var(--transition-normal); }
.form-input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1); }
.form-input:focus ~ .input-icon { color: var(--primary); }
.form-input::placeholder { color: var(--gray-400); }
.form-input.error { border-color: #ef4444; animation: shake 0.5s ease-in-out; }

.password-toggle { position: absolute; right: 0.85rem; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--gray-400); cursor: pointer; padding: 0.25rem; display: flex; align-items: center; justify-content: center; transition: color var(--transition-normal); font-size: 1rem; width: 1.75rem; height: 1.75rem; }
.password-toggle:hover { color: var(--primary); }

.checkbox-group { display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 1.25rem; }
.checkbox-input { width: 1.15rem; height: 1.15rem; accent-color: var(--primary); cursor: pointer; margin-top: 0.15rem; flex-shrink: 0; }
.checkbox-label { color: var(--gray-600); font-size: 0.9rem; cursor: pointer; line-height: 1.4; }
.checkbox-label a { color: var(--primary); text-decoration: none; font-weight: 600; }
.checkbox-label a:hover { text-decoration: underline; }

.btn { display: flex; align-items: center; justify-content: center; width: 100%; padding: 0.9rem 1.5rem; border-radius: var(--border-radius-full); font-family: var(--font-body); font-size: 1rem; font-weight: 600; cursor: pointer; transition: all var(--transition-normal); gap: 0.5rem; border: none; }
.btn-primary { background: var(--primary-gradient); color: white; box-shadow: var(--shadow-blue); }
.btn-primary:hover { transform: translateY(-3px); box-shadow: var(--shadow-blue-lg); }
.btn-primary:active { transform: translateY(-1px); }
.btn-primary:disabled { opacity: 0.7; cursor: not-allowed; transform: none; }
.btn-google { background: var(--white); color: var(--gray-700); border: 2px solid var(--gray-200); margin-top: 1rem; }
.btn-google:hover { background: var(--gray-50); border-color: var(--gray-300); transform: translateY(-2px); }
.btn-google img { width: 20px; height: 20px; }

.divider { display: flex; align-items: center; margin: 1.25rem 0; color: var(--gray-400); font-size: 0.85rem; }
.divider::before, .divider::after { content: ''; flex: 1; height: 1px; background: var(--gray-200); }
.divider span { padding: 0 1rem; }

.forgot-password { text-align: right; margin-bottom: 1.25rem; }
.forgot-password a { color: var(--primary); font-size: 0.85rem; font-weight: 500; text-decoration: none; }
.forgot-password a:hover { text-decoration: underline; }

.message { padding: 0.85rem 1rem; border-radius: var(--border-radius-md); margin-bottom: 1.25rem; display: none; align-items: center; gap: 0.75rem; font-size: 0.9rem; }
.message.show { display: flex; }
.message.error { background: #fef2f2; color: #dc2626; border: 1px solid #fecaca; }
.message.success { background: #f0fdf4; color: #16a34a; border: 1px solid #bbf7d0; }
[data-theme="dark"] .message.error { background: rgba(220, 38, 38, 0.1); border-color: rgba(220, 38, 38, 0.3); }
[data-theme="dark"] .message.success { background: rgba(22, 163, 74, 0.1); border-color: rgba(22, 163, 74, 0.3); }

.spinner { width: 20px; height: 20px; border: 2px solid rgba(255, 255, 255, 0.3); border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite; }

.success-state { display: none; text-align: center; padding: 1.5rem 0; }
.success-state.show { display: block; animation: fadeInUp var(--transition-normal) forwards; }
.success-icon { width: 70px; height: 70px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.25rem; font-size: 2rem; color: white; animation: checkmark 0.5s ease-out; }
.success-state h3 { font-family: var(--font-display); font-size: 1.35rem; font-weight: 700; color: var(--gray-900); margin-bottom: 0.5rem; }
.success-state p { color: var(--gray-500); }



@media (max-width: 576px) {
    .page-title { font-size: 2rem; }
    .auth-card { padding: 1.75rem 1.25rem; margin: 0 0.5rem; }
    .auth-title { font-size: 1.5rem; }
    .tab-btn { padding: 0.6rem 0.75rem; font-size: 0.9rem; }
}


/* ===== FOOTER ===== */
.footer {
    background-color: var(--gray-900);
    color: var(--gray-400);
    padding: 3rem 0 1.5rem;
}

.footer-container {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 1fr;
    gap: 3rem;
}

.footer-brand {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.footer-logo {
    font-family: var(--font-display);
    font-size: 1.75rem;
    font-weight: 800;
    color: white;
    letter-spacing: -0.05em;
}

.footer-description {
    color: var(--gray-500);
    font-size: 0.9rem;
    max-width: 350px;
}

.footer-social {
    display: flex;
    gap: 0.75rem;
}

.social-link {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: var(--border-radius-full);
    background: var(--gray-800);
    color: var(--gray-400);
    font-size: 1.1rem;
    transition: all var(--transition-normal);
}

.social-link:hover {
    background: var(--primary);
    color: white;
    transform: translateY(-3px);
}

.footer-nav {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.footer-nav-title {
    font-size: 1.1rem;
    font-weight: 700;
    color: white;
    margin-bottom: 0.5rem;
}

.footer-nav-links {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.footer-nav-link {
    color: var(--gray-500);
    font-size: 0.9rem;
    transition: all var(--transition-normal);
}

.footer-nav-link:hover {
    color: var(--primary-light);
    transform: translateX(5px);
}

.footer-bottom {
    margin-top: 2.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--gray-800);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.footer-copyright {
    color: var(--gray-500);
    font-size: 0.85rem;
}

@media (max-width: 992px) {
    .footer-container {
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
    }
}

@media (max-width: 768px) {
    .footer-container {
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }
    
    .footer-bottom {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
    }
    
    .footer {
        text-align: center;
    }

    .footer-description {
        margin-left: auto;
        margin-right: auto;
    }

    .footer-social {
        justify-content: center;
    }

    .footer-nav-links {
        align-items: center;
    }
}

/* Footer dark mode */
[data-theme="dark"] .footer {
    background-color: #0d1320;
}

[data-theme="dark"] .footer-logo {
    color: var(--gray-200);
}

[data-theme="dark"] .social-link {
    background: #1e293b;
    color: var(--gray-300);
}

[data-theme="dark"] .social-link:hover {
    background: var(--primary);
    color: white;
}

[data-theme="dark"] .footer-bottom {
    border-top: 1px solid #1e293b;
}

/* User Auth Styles */
.user-auth {
    display: flex;
    align-items: center;
    margin-left: 1rem;
    position: relative;
}

.auth-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: var(--gray-100);
    border-radius: var(--border-radius-full);
    color: var(--gray-600);
    font-size: 1.1rem;
    cursor: pointer;
    transition: all var(--transition-normal);
    border: none;
}

[data-theme="dark"] .auth-btn {
    background: var(--gray-800);
    color: var(--gray-300);
}

.auth-btn:hover {
    background: var(--primary-light);
    color: white;
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: var(--border-radius-full);
    background: var(--primary-gradient);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 1rem;
    cursor: pointer;
    border: 2px solid transparent;
    text-transform: uppercase;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.user-avatar:hover {
    border-color: var(--primary-light);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
}

.user-avatar img {
    width: 100%;
    height: 100%;
    border-radius: var(--border-radius-full);
    object-fit: cover;
}

.profile-dropdown {
    position: absolute;
    top: calc(100% + 10px);
    right: 0;
    background: var(--white);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-xl);
    border: 1px solid var(--gray-200);
    min-width: 220px;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all var(--transition-normal);
    z-index: 200;
    overflow: hidden;
}

.profile-dropdown.active {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.profile-dropdown::before {
    content: '';
    position: absolute;
    top: -6px;
    right: 16px;
    width: 12px;
    height: 12px;
    background: var(--white);
    border: 1px solid var(--gray-200);
    border-right: none;
    border-bottom: none;
    transform: rotate(45deg);
}

.profile-header {
    padding: 1rem;
    border-bottom: 1px solid var(--gray-200);
    background: var(--gray-50);
}

.profile-name {
    font-weight: 600;
    color: var(--gray-900);
    font-size: 0.95rem;
    margin-bottom: 0.2rem;
}

.profile-email {
    font-size: 0.8rem;
    color: var(--gray-500);
    word-break: break-all;
}

.profile-menu {
    padding: 0.5rem 0;
}

.profile-menu-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
    color: var(--gray-700);
    font-size: 0.9rem;
    cursor: pointer;
    transition: all var(--transition-fast);
    border: none;
    background: none;
    width: 100%;
    text-align: left;
}

.profile-menu-item:hover {
    background: var(--gray-100);
    color: var(--primary);
}

.profile-menu-item i {
    width: 18px;
    text-align: center;
    font-size: 0.95rem;
}

.profile-menu-item.logout {
    color: #dc2626;
}

.profile-menu-item.logout:hover {
    background: #fef2f2;
    color: #dc2626;
}

[data-theme="dark"] .profile-dropdown {
    background: var(--gray-100);
    border-color: var(--gray-200);
}

[data-theme="dark"] .profile-dropdown::before {
    background: var(--gray-100);
    border-color: var(--gray-200);
}

[data-theme="dark"] .profile-header {
    background: var(--gray-50);
    border-color: var(--gray-200);
}

[data-theme="dark"] .profile-menu-item:hover {
    background: var(--gray-200);
}

[data-theme="dark"] .profile-menu-item.logout:hover {
    background: rgba(220, 38, 38, 0.1);
}

.user-auth .auth-btn { display: flex; }
.user-auth .user-avatar { display: none; }
.user-auth .profile-dropdown { display: none; }

.user-auth.logged-in .auth-btn { display: none; }
.user-auth.logged-in .user-avatar { display: flex; }
.user-auth.logged-in .profile-dropdown { display: block; }

@media (max-width: 992px) {
    .user-auth {
        margin-left: 0.5rem;
        margin-right: 0.75rem;
    }
}

@media (max-width: 480px) {
    .user-auth {
        margin-left: 0.5rem;
        margin-right: 0.5rem;
    }
    
    .auth-btn,
    .user-avatar {
        width: 36px;
        height: 36px;
        font-size: 0.9rem;
    }
    
    .profile-dropdown {
        position: fixed;
        top: var(--header-height);
        right: 1rem;
        left: 1rem;
        min-width: auto;
    }
}


/* Modal Conditions d'utilisation */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
    z-index: 1000;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 1rem;
}

.modal-overlay.active {
    display: flex;
}

.modal {
    background: var(--white);
    border-radius: var(--border-radius-xl);
    box-shadow: var(--shadow-xl);
    width: 100%;
    max-width: 600px;
    max-height: 85vh;
    display: flex;
    flex-direction: column;
    animation: fadeInUp 0.3s ease;
}

.modal-header {
    padding: 1.5rem;
    border-bottom: 1px solid var(--gray-200);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.modal-title {
    font-family: var(--font-display);
    font-size: 1.35rem;
    font-weight: 700;
    color: var(--gray-900);
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.modal-title i {
    color: var(--primary);
}

.modal-close {
    width: 36px;
    height: 36px;
    border-radius: var(--border-radius-full);
    background: var(--gray-100);
    color: var(--gray-500);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition-normal);
}

.modal-close:hover {
    background: var(--gray-200);
    color: var(--gray-700);
}

.modal-body {
    padding: 1.5rem;
    overflow-y: auto;
    flex: 1;
}

.modal-body h3 {
    font-size: 1rem;
    font-weight: 600;
    color: var(--gray-800);
    margin: 1.25rem 0 0.5rem;
}

.modal-body h3:first-child {
    margin-top: 0;
}

.modal-body p, .modal-body li {
    font-size: 0.9rem;
    color: var(--gray-600);
    line-height: 1.6;
}

.modal-body ul {
    margin: 0.5rem 0;
    padding-left: 1.25rem;
}

.modal-body li {
    margin-bottom: 0.35rem;
}

.modal-footer {
    padding: 1.25rem 1.5rem;
    border-top: 1px solid var(--gray-200);
    display: flex;
    gap: 1rem;
    justify-content: flex-end;
}

.modal-footer .btn {
    padding: 0.75rem 1.5rem;
    width: auto;
}

.btn-secondary {
    background: var(--gray-100);
    color: var(--gray-700);
}

.btn-secondary:hover {
    background: var(--gray-200);
}


/* Cible les écrans avec une petite hauteur (téléphone en mode paysage) */
@media (max-height: 500px) and (orientation: landscape) {
    /* Désactiver le header sticky */
    .header {
        position: relative;
    }
    
    /* Ajuster le contenu principal */
    .main-content {
        padding-top: 0;
    }
    
    /* Désactiver le sticky sur le section-header du tableau */
    #page-items .section-header {
        position: relative;
        top: auto;
    }
    
    /* Désactiver le sticky sur les en-têtes du tableau */
    #page-items .items-table th {
        position: static;
        top: auto;
    }
    
    /* Permettre le scroll horizontal du tableau */
    #page-items .items-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        max-width: 100vw;
    }
    
    /* S'assurer que la page ne dépasse pas l'écran */
    body {
        overflow-x: hidden;
    }
    
    .container {
        max-width: 100%;
        overflow-x: hidden;
    }
    
    #page-items .section-card {
        overflow: visible;
        max-width: 100%;
    }
    
    /* Réduire la taille du page-header en paysage */
    .page-header {
        padding: 0.5rem 0;
    }
    
    .page-header .page-title {
        font-size: 1.2rem;
    }
    
    .page-header .page-subtitle,
    .page-header .welcome-message {
        display: none;
    }
}

/* =============================================
   NOUVEAU HEADER - MENUS DÉROULANTS
   ============================================= */

.nav-items {
    display: flex;
    list-style: none;
    gap: 1.5rem;
    margin: 0;
    padding: 0;
    align-items: center;
}

.nav-dropdown {
    position: relative;
}

.nav-dropdown-trigger {
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
    font-weight: 500;
    color: var(--gray-700);
    transition: color var(--transition-normal), transform var(--transition-normal);
    padding: 0.5rem 0;
    background: none;
    border: none;
    font-family: var(--font-body);
    font-size: 1rem;
    position: relative;
}

[data-theme="dark"] .nav-dropdown-trigger {
    color: white;
}

.nav-dropdown-trigger:hover {
    color: var(--primary);
}

.nav-dropdown-trigger::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background: var(--primary-gradient);
    transition: width 0.3s ease;
}

.nav-dropdown:hover .nav-dropdown-trigger::after {
    width: 100%;
}

.nav-dropdown-trigger i:first-child {
    font-size: 0.9rem;
}

.dropdown-chevron {
    font-size: 0.7rem;
    transition: transform 0.3s ease;
}

.nav-dropdown:hover .dropdown-chevron {
    transform: rotate(180deg);
}

.nav-dropdown-content {
    position: absolute;
    top: 100%;
    left: -10px;
    background: var(--white);
    min-width: 240px;
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    padding: 8px 0;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: all 0.3s ease;
    border: 1px solid var(--gray-200);
}

[data-theme="dark"] .nav-dropdown-content {
    background: var(--gray-100);
    border-color: var(--gray-200);
}

.nav-dropdown:hover .nav-dropdown-content {
    opacity: 1;
    visibility: visible;
    transform: translateY(5px);
}

.dropdown-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 18px;
    color: var(--gray-700);
    text-decoration: none;
    transition: all 0.2s ease;
    font-family: var(--font-body);
    font-size: 0.95rem;
}

[data-theme="dark"] .dropdown-item {
    color: white;
}

.dropdown-item:hover {
    background-color: var(--gray-100);
    color: var(--primary);
}

[data-theme="dark"] .dropdown-item:hover {
    background-color: var(--gray-200);
    color: var(--primary-light);
}

.dropdown-item.active {
    background-color: rgba(59, 130, 246, 0.1);
    color: var(--primary);
    font-weight: 600;
}

[data-theme="dark"] .dropdown-item.active {
    background-color: rgba(96, 165, 250, 0.15);
    color: var(--primary-light);
}

.dropdown-item i {
    font-size: 1rem;
    width: 20px;
    text-align: center;
}

/* =============================================
   MENU MOBILE
   ============================================= */

.mobile-menu {
    position: fixed;
    top: var(--header-height);
    left: 0;
    width: 100%;
    max-height: calc(100vh - var(--header-height));
    overflow-y: auto;
    background-color: var(--white);
    padding: 1rem;
    z-index: calc(var(--z-sticky) - 1);
    box-shadow: var(--shadow-lg);
    transform: translateY(-100%);
    opacity: 0;
    visibility: hidden;
    transition: transform var(--transition-normal), opacity var(--transition-normal), visibility var(--transition-normal);
}

[data-theme="dark"] .mobile-menu {
    background-color: var(--gray-50);
}

.mobile-menu.active {
    transform: translateY(0);
    opacity: 1;
    visibility: visible;
}

.mobile-menu-section {
    margin-bottom: 1.5rem;
}

.mobile-menu-title {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 700;
    font-size: 0.85rem;
    color: var(--primary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    padding: 0.5rem 0;
    border-bottom: 2px solid var(--primary);
    margin-bottom: 0.75rem;
}

.mobile-menu-link {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 0.85rem 1rem;
    color: var(--gray-700);
    text-decoration: none;
    border-radius: 8px;
    transition: all 0.2s ease;
    font-size: 0.95rem;
}

[data-theme="dark"] .mobile-menu-link {
    color: var(--gray-300);
}

.mobile-menu-link:hover {
    background-color: var(--gray-100);
    color: var(--primary);
}

.mobile-menu-link.active {
    background-color: rgba(59, 130, 246, 0.1);
    color: var(--primary);
    font-weight: 600;
}

.mobile-menu-link i {
    font-size: 1rem;
    width: 22px;
    text-align: center;
}

/* =============================================
   ICÔNES HEADER MOBILE
   ============================================= */

.header-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

@media (max-width: 992px) {
    .nav-items {
        display: none;
    }
    
    .header-actions {
        gap: 0.4rem;
    }
    
    .theme-toggle,
    .auth-btn,
    .user-avatar,
    .mobile-menu-btn {
        width: 38px;
        height: 38px;
        font-size: 1.1rem;
    }
    
    .theme-toggle {
        margin-left: 0;
    }
    
    .user-auth {
        margin-left: 0;
    }
    
    .mobile-menu-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--gray-100);
        border-radius: var(--border-radius-full);
        color: var(--gray-600);
        transition: all var(--transition-normal);
    }
    
    [data-theme="dark"] .mobile-menu-btn {
        background: var(--gray-800);
        color: var(--gray-300);
    }
    
    .mobile-menu-btn:hover {
        background: var(--primary-light);
        color: white;
    }
}

@media (min-width: 993px) {
    .mobile-menu {
        display: none !important;
    }
}

@media (max-width: 480px) {
    .header-actions {
        gap: 0.3rem;
    }
    
    .theme-toggle,
    .auth-btn,
    .user-avatar,
    .mobile-menu-btn {
        width: 36px;
        height: 36px;
        font-size: 1rem;
    }
}

</style>

<!-- Firebase Authentication Script -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, getDoc, setDoc, Timestamp, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyBSJPwPWOAGnWwQN3j2qwu8pxf2iCdO-Gc",
    authDomain: "typixclin-b5fa9.firebaseapp.com",
    projectId: "typixclin-b5fa9",
    storageBucket: "typixclin-b5fa9.firebasestorage.app",
    messagingSenderId: "726560091078",
    appId: "1:726560091078:web:5ce8b31da0bfbbc1f720c7",
    measurementId: "G-9CZ2QB6TNK"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const userAuth = document.getElementById('user-auth');
const userAvatar = document.getElementById('user-avatar');
const avatarInitials = document.getElementById('avatar-initials');
const profileDropdown = document.getElementById('profile-dropdown');
const profileName = document.getElementById('profile-name');
const profileEmail = document.getElementById('profile-email');
const logoutBtn = document.getElementById('logout-btn');

function getInitials(name) {
    if (!name) return 'U';
    const names = name.trim().split(' ');
    if (names.length >= 2) {
        return (names[0][0] + names[names.length - 1][0]).toUpperCase();
    }
    return name.substring(0, 2).toUpperCase();
}

async function updateUserUI(user) {
    if (user) {
        userAuth.classList.add('logged-in');
        try {
            const userDoc = await getDoc(doc(db, 'users', user.uid));
            const userData = userDoc.exists() ? userDoc.data() : {};
            const displayName = userData.displayName || user.displayName || 'Utilisateur';
            const email = user.email || '';
            const photoURL = userData.photoURL || user.photoURL || '';
            
            if (photoURL) {
                avatarInitials.innerHTML = `<img src="${photoURL}" alt="Photo de profil">`;
            } else {
                avatarInitials.textContent = getInitials(displayName);
            }
            profileName.textContent = displayName;
            profileEmail.textContent = email;
        } catch (error) {
            avatarInitials.textContent = getInitials(user.displayName || user.email);
            profileName.textContent = user.displayName || 'Utilisateur';
            profileEmail.textContent = user.email || '';
        }
    } else {
        userAuth.classList.remove('logged-in');
        profileDropdown.classList.remove('active');
    }
}

onAuthStateChanged(auth, (user) => { updateUserUI(user); });

if (userAvatar) {
    userAvatar.addEventListener('click', (e) => {
        e.stopPropagation();
        profileDropdown.classList.toggle('active');
    });
}

document.addEventListener('click', (e) => {
    if (profileDropdown && !profileDropdown.contains(e.target) && !userAvatar.contains(e.target)) {
        profileDropdown.classList.remove('active');
    }
});

if (logoutBtn) {
    logoutBtn.addEventListener('click', async () => {
        try {
            await signOut(auth);
            profileDropdown.classList.remove('active');
        } catch (error) {
            console.error('Erreur lors de la déconnexion:', error);
        }
    });
}
</script>

</head>
<body>

<!-- Header -->
<header class="header" id="header">
    <div class="container header-container">
        <a href="index.html" class="logo">
            <span class="logo-icon"><i class="fas fa-stethoscope"></i></span>
            TypixClin
        </a>
        
        <nav class="nav">
            <ul class="nav-items">
                <!-- OUTILS -->
                <li class="nav-dropdown">
                    <button class="nav-dropdown-trigger">
                        <i class="fas fa-toolbox"></i> Outils
                        <i class="fas fa-chevron-down dropdown-chevron"></i>
                    </button>
                    <div class="nav-dropdown-content">
                        <a href="examen-adulte.html" class="dropdown-item"><i class="fas fa-user-md"></i> Examen Adulte</a>
                        <a href="examen-pédiatrique.html" class="dropdown-item"><i class="fas fa-baby"></i> Examen Pédiatrique</a>
                        <a href="examen-réanimation.html" class="dropdown-item"><i class="fas fa-procedures"></i> Examen Réanimation</a>
                        <a href="ecg.html" class="dropdown-item"><i class="fas fa-heartbeat"></i> ECG</a>
                        <a href="gds.html" class="dropdown-item"><i class="fas fa-tint"></i> Gaz du Sang</a>
                        <a href="Troubles ioniques.html" class="dropdown-item"><i class="fas fa-flask"></i> Troubles Ioniques</a>
                    </div>
                </li>
                
                <!-- FICHES -->
                <li class="nav-dropdown">
                    <button class="nav-dropdown-trigger">
                        <i class="fas fa-clipboard"></i> Fiches
                        <i class="fas fa-chevron-down dropdown-chevron"></i>
                    </button>
                    <div class="nav-dropdown-content">
                        <a href="Fiche-examen-clinique.html" class="dropdown-item"><i class="fas fa-notes-medical"></i> Fiche Examen Clinique</a>
                        <a href="Fiche-ECG.html" class="dropdown-item"><i class="fas fa-heartbeat"></i> Fiche ECG</a>
                    </div>
                </li>
                
                <!-- RESSOURCES -->
                <li class="nav-dropdown">
                    <button class="nav-dropdown-trigger">
                        <i class="fas fa-folder-open"></i> Ressources
                        <i class="fas fa-chevron-down dropdown-chevron"></i>
                    </button>
                    <div class="nav-dropdown-content">
                        <a href="FichierGsheet.html" class="dropdown-item"><i class="fas fa-table"></i> Tableur Gsheet Externat</a>
                        <a href="TableurEnLigne.html" class="dropdown-item"><i class="fas fa-calculator"></i> Tableur en ligne Externat</a>
                        <a href="index.html" class="dropdown-item"><i class="fas fa-book"></i> Carnet de stage</a>
                    </div>
                </li>
            </ul>
            
            <div class="header-actions">
                <button class="theme-toggle" id="theme-toggle"><i class="fas fa-sun"></i></button>
                
                <div class="user-auth" id="user-auth">
                    <a href="auth.html" class="auth-btn" title="Se connecter"><i class="fas fa-user"></i></a>
                    <div class="user-avatar" id="user-avatar" title="Mon profil"><span id="avatar-initials">JD</span></div>
                    <div class="profile-dropdown" id="profile-dropdown">
                        <div class="profile-header">
                            <div class="profile-name" id="profile-name">Jean Dupont</div>
                            <div class="profile-email" id="profile-email">email@exemple.com</div>
                        </div>
                        <div class="profile-menu">
							<button class="profile-menu-item logout" id="logout-btn"><i class="fas fa-sign-out-alt"></i><span>Se déconnecter</span></button>
                        </div>
                    </div>
                </div>
                
                <button class="mobile-menu-btn" id="mobile-menu-btn"><i class="fas fa-bars"></i></button>
            </div>
        </nav>
    </div>
</header>

<!-- Mobile Menu -->
<div class="mobile-menu" id="mobile-menu">
    <div class="mobile-menu-section">
        <div class="mobile-menu-title"><i class="fas fa-toolbox"></i> Outils</div>
        <a href="examen-adulte.html" class="mobile-menu-link"><i class="fas fa-user-md"></i> Examen Adulte</a>
        <a href="examen-pédiatrique.html" class="mobile-menu-link"><i class="fas fa-baby"></i> Examen Pédiatrique</a>
        <a href="examen-réanimation.html" class="mobile-menu-link"><i class="fas fa-procedures"></i> Examen Réanimation</a>
        <a href="ecg.html" class="mobile-menu-link"><i class="fas fa-heartbeat"></i> ECG</a>
        <a href="gds.html" class="mobile-menu-link"><i class="fas fa-tint"></i> Gaz du Sang</a>
        <a href="Troubles ioniques.html" class="mobile-menu-link"><i class="fas fa-flask"></i> Troubles Ioniques</a>
    </div>
    
    <div class="mobile-menu-section">
        <div class="mobile-menu-title"><i class="fas fa-clipboard"></i> Fiches</div>
        <a href="Fiche-examen-clinique.html" class="mobile-menu-link"><i class="fas fa-notes-medical"></i> Fiche Examen Clinique</a>
        <a href="Fiche-ECG.html" class="mobile-menu-link"><i class="fas fa-heartbeat"></i> Fiche ECG</a>
    </div>
    
    <div class="mobile-menu-section">
        <div class="mobile-menu-title"><i class="fas fa-folder-open"></i> Ressources</div>
        <a href="FichierGsheet.html" class="mobile-menu-link"><i class="fas fa-table"></i> Tableur Gsheet Externat</a>
        <a href="TableurEnLigne.html" class="mobile-menu-link"><i class="fas fa-calculator"></i> Tableur en ligne Externat</a>
        <a href="index.html" class="mobile-menu-link"><i class="fas fa-book"></i> Carnet de stage</a>
    </div>
</div>

<section class="page-header">
    <div class="container">
        <h1 class="page-title">Connexion</h1>
        <p class="page-subtitle">Accédez à votre espace personnel TypixClin</p>
        <a href="index.html" class="back-home-btn">
            <i class="fas fa-arrow-left"></i>
            Retour à l'accueil
        </a>
    </div>
</section>

<main class="main-content">
    <div class="auth-card">
        <div class="auth-header">
            <div class="auth-icon"><i class="fas fa-user-md"></i></div>
            <h2 class="auth-title">Bienvenue</h2>
            <p class="auth-subtitle">Connectez-vous ou créez un compte</p>
        </div>

        <div class="auth-tabs">
            <button class="tab-btn active" data-tab="login">Connexion</button>
            <button class="tab-btn" data-tab="register">Inscription</button>
        </div>

        <div class="message" id="auth-message">
            <i class="fas fa-info-circle"></i>
            <span></span>
        </div>

        <form class="auth-form active" id="login-form">
            <div class="form-group">
                <label class="form-label" for="login-email">Email</label>
                <div class="input-wrapper">
                    <input type="email" id="login-email" name="email" autocomplete="email" class="form-input" placeholder="votre@email.com" required>
                    <i class="fas fa-envelope input-icon"></i>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label" for="login-password">Mot de passe</label>
                <div class="input-wrapper">
                    <input type="password" id="login-password" name="password" autocomplete="current-password" class="form-input" placeholder="••••••••" required>
                    <i class="fas fa-lock input-icon"></i>
                </div>
            </div>
            <div class="forgot-password">
                <a href="#" id="forgot-password-link">Mot de passe oublié ?</a>
            </div>
            <button type="submit" class="btn btn-primary" id="login-btn"><span>Se connecter</span></button>

        </form>

        <form class="auth-form" id="register-form">
			<div class="form-group">
				<label class="form-label" for="register-firstname">Prénom</label>
				<div class="input-wrapper">
					<input type="text" id="register-firstname" name="firstname" autocomplete="given-name" class="form-input" placeholder="Jean" required>
					<i class="fas fa-user input-icon"></i>
				</div>
			</div>
			<div class="form-group">
				<label class="form-label" for="register-lastname">Nom de famille</label>
				<div class="input-wrapper">
					<input type="text" id="register-lastname" name="lastname" autocomplete="family-name" class="form-input" placeholder="Dupont" required>
					<i class="fas fa-user input-icon"></i>
				</div>
			</div>
            <div class="form-group">
                <label class="form-label" for="register-email">Email</label>
                <div class="input-wrapper">
                    <input type="email" id="register-email" name="email" autocomplete="email" class="form-input" placeholder="votre@email.com" required>
                    <i class="fas fa-envelope input-icon"></i>
                </div>
            </div>
			<div class="form-group">
				<label class="form-label" for="register-password">Mot de passe</label>
				<div class="input-wrapper">
					<input type="password" id="register-password" class="form-input" placeholder="Minimum 6 caractères" required minlength="6">
					<i class="fas fa-lock input-icon"></i>
				</div>
			</div>
			<div class="form-group">
				<label class="form-label" for="register-password-confirm">Confirmer le mot de passe</label>
				<div class="input-wrapper">
					<input type="password" id="register-password-confirm" class="form-input" placeholder="Retapez votre mot de passe" required minlength="6">
					<i class="fas fa-lock input-icon"></i>
				</div>
				<small id="password-match-hint" style="display: none; margin-top: 0.35rem; font-size: 0.8rem;"></small>
			</div>

            <div class="checkbox-group">
                <input type="checkbox" id="terms" class="checkbox-input" required>
                <label for="terms" class="checkbox-label">J'accepte les <a href="#" id="terms-link">conditions d'utilisation</a></label>
            </div>
            <button type="submit" class="btn btn-primary" id="register-btn"><span>Créer mon compte</span></button>

        </form>

        <div class="success-state" id="success-state">
            <div class="success-icon"><i class="fas fa-check"></i></div>
            <h3>Connexion réussie !</h3>
            <p>Redirection en cours...</p>
        </div>
    </div>
</main>


<footer class="footer">
    <div class="container">
        <div class="footer-container">
            <div class="footer-brand">
                <div class="footer-logo">TypixClin</div>
                <p class="footer-description">Plateforme d'aide à la rédaction des examens cliniques pour étudiants en médecine.</p>
                <div class="footer-social">
                    <a href="https://github.com/JEZENN/TypixClin" class="social-link"><i class="fab fa-github"></i></a>
                </div>
            </div>
            
            <div class="footer-nav">
                <h4 class="footer-nav-title">Outils</h4>
                <div class="footer-nav-links">
                    <a href="examen-adulte.html" class="footer-nav-link">Examen Adulte</a>
                    <a href="examen-pédiatrique.html" class="footer-nav-link">Examen Pédiatrique</a>
                    <a href="examen-réanimation.html" class="footer-nav-link">Examen Réanimation</a>
                    <a href="ecg.html" class="footer-nav-link">ECG</a>
                    <a href="gds.html" class="footer-nav-link">Gaz du sang</a>
                    <a href="Troubles ioniques.html" class="footer-nav-link">Troubles ioniques</a>
                </div>
            </div>
            
            <div class="footer-nav">
                <h4 class="footer-nav-title">Fiches et ressources</h4>
                <div class="footer-nav-links">
                    <a href="Fiche-examen-clinique.html" class="footer-nav-link">Fiche Examen Clinique</a>
                    <a href="Fiche-ECG.html" class="footer-nav-link">Fiche ECG</a>
					<a href="FichierGsheet.html" class="footer-nav-link">Tableur Gsheet Externat</a>
					<a href="TableurEnLigne.html" class="footer-nav-link">Tableur en ligne Externat</a>
					<a href="index.html" class="footer-nav-link">Carnet de stage</a>

                </div>
            </div>
            
            <div class="footer-nav">
                <h4 class="footer-nav-title">À propos</h4>
                <div class="footer-nav-links">
                    <a href="index.html#tools" class="footer-nav-link">Outils</a>
                    <a href="index.html#ai" class="footer-nav-link">IA</a>
                    <a href="index.html#feedback" class="footer-nav-link">Feedback</a>
                    <a href="MentionsLégales.html" class="footer-nav-link">Mentions légales</a>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom">
            <div class="footer-copyright">TypixClin © 2025, Jean ZENNARO</div>
        </div>
    </div>
</footer>


<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signInWithPopup, GoogleAuthProvider, sendPasswordResetEmail, sendEmailVerification, updateProfile, onAuthStateChanged, signOut} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc, collection, query, where, getDocs, serverTimestamp, Timestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBSJPwPWOAGnWwQN3j2qwu8pxf2iCdO-Gc",
  authDomain: "typixclin-b5fa9.firebaseapp.com",
  projectId: "typixclin-b5fa9",
  storageBucket: "typixclin-b5fa9.firebasestorage.app",
  messagingSenderId: "726560091078",
  appId: "1:726560091078:web:5ce8b31da0bfbbc1f720c7",
  measurementId: "G-9CZ2QB6TNK"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const googleProvider = new GoogleAuthProvider();


const tabBtns = document.querySelectorAll('.tab-btn');
const loginForm = document.getElementById('login-form');
const registerForm = document.getElementById('register-form');
const authMessage = document.getElementById('auth-message');
const successState = document.getElementById('success-state');

function showMessage(text, type = 'error') {
    const icon = authMessage.querySelector('i');
    authMessage.querySelector('span').textContent = text;
    authMessage.className = `message show ${type}`;
    icon.className = type === 'error' ? 'fas fa-exclamation-circle' : 'fas fa-check-circle';
}

function hideMessage() { authMessage.classList.remove('show'); }

function setLoading(button, loading) {
    const span = button.querySelector('span');
    if (loading) { button.disabled = true; span.innerHTML = '<div class="spinner"></div>'; }
    else { button.disabled = false; span.textContent = button.id.includes('login') ? 'Se connecter' : 'Créer mon compte'; }
}

function showSuccess() {
    loginForm.style.display = 'none';
    registerForm.style.display = 'none';
    document.querySelector('.auth-tabs').style.display = 'none';
    hideMessage();
    successState.classList.add('show');
}

// Récupérer la page de redirection depuis l'URL
const urlParams = new URLSearchParams(window.location.search);
const redirectPage = urlParams.get('redirect') || 'index.html';



async function createUserProfile(user, additionalData = {}) {
    const userRef = doc(db, 'users', user.uid);
    const snapshot = await getDoc(userRef);
    if (!snapshot.exists()) {
        const { displayName, email, photoURL } = user;
        await setDoc(userRef, { 
            displayName: displayName || additionalData.displayName || '', 
            email, 
            photoURL: photoURL || '', 
            
            createdAt: serverTimestamp(), 
            checklists: {}, 
            preferences: { theme: 'light' } 
        });
    }
}

function translateError(errorCode) {
    const errors = { 'auth/email-already-in-use': 'Cette adresse email est déjà utilisée.', 'auth/invalid-email': 'Adresse email invalide.', 'auth/weak-password': 'Le mot de passe doit contenir au moins 6 caractères.', 'auth/user-not-found': 'Aucun compte associé à cet email.', 'auth/wrong-password': 'Mot de passe incorrect.', 'auth/invalid-credential': 'Email ou mot de passe incorrect.', 'auth/too-many-requests': 'Trop de tentatives. Réessayez plus tard.', 'auth/popup-closed-by-user': 'Connexion annulée.', 'auth/network-request-failed': 'Erreur réseau. Vérifiez votre connexion.' };
    return errors[errorCode] || 'Une erreur est survenue. Réessayez.';
}

tabBtns.forEach(btn => {
    btn.addEventListener('click', () => {
        tabBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        hideMessage();
        if (btn.dataset.tab === 'login') { loginForm.classList.add('active'); registerForm.classList.remove('active'); }
        else { loginForm.classList.remove('active'); registerForm.classList.add('active'); }
    });
});

document.querySelectorAll('.password-toggle').forEach(toggle => {
    toggle.addEventListener('click', () => {
        const input = document.getElementById(toggle.dataset.target);
        const icon = toggle.querySelector('i');
        if (input.type === 'password') { input.type = 'text'; icon.classList.replace('fa-eye', 'fa-eye-slash'); }
        else { input.type = 'password'; icon.classList.replace('fa-eye-slash', 'fa-eye'); }
    });
});

loginForm.addEventListener('submit', async (e) => {
    e.preventDefault(); hideMessage();
    const email = document.getElementById('login-email').value;
    const password = document.getElementById('login-password').value;
    const loginBtn = document.getElementById('login-btn');
    setLoading(loginBtn, true);
    try {
        const cred = await signInWithEmailAndPassword(auth, email, password);

			if (!cred.user.emailVerified) {
				showMessage(
				  "Merci de vérifier votre email avant de vous connecter."
				);
				await signOut(auth);
				return;
			}

			showSuccess();

        setTimeout(() => { window.location.href = redirectPage; }, 1500);
    } catch (error) {
        showMessage(translateError(error.code));
        document.getElementById('login-password').classList.add('error');
        setTimeout(() => { document.getElementById('login-password').classList.remove('error'); }, 500);
    } finally { setLoading(loginBtn, false); }
});

registerForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    hideMessage();

    console.log('🔵 Début inscription');

    const firstname = document.getElementById('register-firstname').value.trim();
    const lastname = document.getElementById('register-lastname').value.trim();
    const name = firstname + ' ' + lastname;
    const email = document.getElementById('register-email').value;
    const password = document.getElementById('register-password').value;
    const passwordConfirm = document.getElementById('register-password-confirm').value;
    const registerBtn = document.getElementById('register-btn');

    console.log('🔵 Données récupérées');

    if (password !== passwordConfirm) {
        showMessage('Les mots de passe ne correspondent pas.');
        return;
    }

    setLoading(registerBtn, true);

    try {
        console.log('🔵 Tentative création compte Firebase Auth...');
        const { user } = await createUserWithEmailAndPassword(auth, email, password);
        console.log('✅ Compte Auth créé:', user.uid);

        console.log('🔵 Mise à jour profil...');
        await updateProfile(user, { displayName: name });
        console.log('✅ Profil mis à jour');

        console.log('🔵 Envoi email vérification...');
        await sendEmailVerification(user);
        console.log('✅ Email envoyé');

        // Déterminer le type de premium selon la date de création
        console.log('🔵 Calcul période de grâce...');
        const now = new Date();
        const cutoffDate = new Date('2026-09-01T00:00:00Z');
        const gracePeriodEnd = new Date('2026-10-25T23:59:59Z');

        let premiumData = {};

        if (now < cutoffDate) {
            console.log('✅ Période de grâce activée');
            premiumData = {
                isPremium: true,
                premiumType: 'grace_period',
                gracePeriodEnd: Timestamp.fromDate(gracePeriodEnd)
            };
        } else {
            console.log('⚠️ Pas de période de grâce (après cutoff)');
            premiumData = {
                isPremium: false,
                premiumType: null,
                gracePeriodEnd: null
            };
        }

        console.log('🔵 Écriture dans Firestore...');
        await setDoc(doc(db, 'users', user.uid), {
            displayName: name,
            firstName: firstname,
            lastName: lastname,
            email,
            photoURL: '',
            createdAt: serverTimestamp(),
            ...premiumData,
            stripeCustomerId: null,
            stripeSubscriptionId: null,
            subscriptionStatus: null,
            subscriptionEndDate: null,
            lastUpdated: serverTimestamp(),
            checklists: {},
            preferences: { theme: 'light' }
        });
        console.log('✅ Document Firestore créé');

        console.log('🔵 Déconnexion...');
        await signOut(auth);
        console.log('✅ Déconnecté');

        // Retour onglet connexion
        document.querySelector('[data-tab="login"]').click();

        showMessage(
            "📧 Un email de vérification a été envoyé. Merci de le vérifier avant de vous connecter.",
            "success"
        );

        registerForm.reset();
        console.log('✅ INSCRIPTION COMPLÈTE');

    } catch (error) {
        console.error('❌ ERREUR COMPLÈTE:', error);
        console.error('❌ Message:', error.message);
        console.error('❌ Code:', error.code);
        console.error('❌ Stack:', error.stack);
        showMessage(translateError(error.code));
    } finally {
        setLoading(registerBtn, false);
    }
});


// Validation en temps réel de la confirmation du mot de passe
const passwordField = document.getElementById('register-password');
const passwordConfirmField = document.getElementById('register-password-confirm');
const passwordMatchHint = document.getElementById('password-match-hint');

function checkPasswordMatch() {
    const password = passwordField.value;
    const passwordConfirm = passwordConfirmField.value;
    
    if (passwordConfirm.length === 0) {
        passwordMatchHint.style.display = 'none';
        passwordConfirmField.style.borderColor = '';
        return;
    }
    
    passwordMatchHint.style.display = 'block';
    
    if (password === passwordConfirm) {
        passwordMatchHint.textContent = '✓ Les mots de passe correspondent';
        passwordMatchHint.style.color = '#16a34a';
        passwordConfirmField.style.borderColor = '#16a34a';
    } else {
        passwordMatchHint.textContent = '✗ Les mots de passe ne correspondent pas';
        passwordMatchHint.style.color = '#dc2626';
        passwordConfirmField.style.borderColor = '#dc2626';
    }
}

passwordField.addEventListener('input', checkPasswordMatch);
passwordConfirmField.addEventListener('input', checkPasswordMatch);


document.getElementById('google-login-btn')?.addEventListener('click', handleGoogleAuth);
document.getElementById('google-register-btn')?.addEventListener('click', handleGoogleAuth);

async function handleGoogleAuth() {
    hideMessage();
    try {
        const result = await signInWithPopup(auth, googleProvider);
        await createUserProfile(result.user);
        showSuccess();
        setTimeout(() => { window.location.href = redirectPage; }, 1500);
    } catch (error) { if (error.code !== 'auth/popup-closed-by-user') showMessage(translateError(error.code)); }
}

// MOT DE PASSE OUBLIÉ - Firebase sécurisé
document.getElementById('forgot-password-link').addEventListener('click', async (e) => {
    e.preventDefault();
    const email = document.getElementById('login-email').value.trim();

    if (!email) {
        showMessage("Entre ton email pour recevoir le lien de réinitialisation.");
        return;
    }

    try {
        await sendPasswordResetEmail(auth, email);
        showMessage(
            "Un email de réinitialisation a été envoyé.",
            "success"
        );
    } catch (error) {
        showMessage(translateError(error.code));
    }
});


onAuthStateChanged(auth, (user) => { if (user) { /* window.location.href = 'index.html'; */ } });

document.addEventListener('DOMContentLoaded', function() {
    const header = document.getElementById('header');
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    const themeToggle = document.getElementById('theme-toggle');
    const themeIcon = themeToggle.querySelector('i');

    mobileMenuBtn.addEventListener('click', function() {
        mobileMenu.classList.toggle('active');
        mobileMenuBtn.innerHTML = mobileMenu.classList.contains('active') ? '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
    });

    document.querySelectorAll('.mobile-menu .nav-link').forEach(link => {
        link.addEventListener('click', function() { mobileMenu.classList.remove('active'); mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>'; });
    });

    function setTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        themeIcon.classList.remove('fa-sun', 'fa-moon');
        themeIcon.classList.add(theme === 'dark' ? 'fa-moon' : 'fa-sun');
    }

    setTheme(localStorage.getItem('theme') || 'light');
    themeToggle.addEventListener('click', function() { setTheme(document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'); });
    window.addEventListener('scroll', function() { header.classList.toggle('scrolled', window.pageYOffset > 0); });
});


// Modal Conditions d'utilisation
const termsLink = document.getElementById('terms-link');
const termsModal = document.getElementById('terms-modal');
const modalClose = document.getElementById('modal-close');
const modalCancel = document.getElementById('modal-cancel');
const modalAccept = document.getElementById('modal-accept');
const termsCheckbox = document.getElementById('terms');

termsLink.addEventListener('click', (e) => {
    e.preventDefault();
    termsModal.classList.add('active');
    document.body.style.overflow = 'hidden';
});

function closeModal() {
    termsModal.classList.remove('active');
    document.body.style.overflow = '';
}

modalClose.addEventListener('click', closeModal);
modalCancel.addEventListener('click', closeModal);

termsModal.addEventListener('click', (e) => {
    if (e.target === termsModal) closeModal();
});

modalAccept.addEventListener('click', () => {
    termsCheckbox.checked = true;
    closeModal();
});

document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && termsModal.classList.contains('active')) {
        closeModal();
    }
});
// Gestion de la touche Tab pour mettre le focus sur les boutons de soumission
document.getElementById('login-password').addEventListener('keydown', (e) => {
    if (e.key === 'Tab' && !e.shiftKey) {
        e.preventDefault();
        document.getElementById('login-btn').focus();
    }
});

document.getElementById('register-password-confirm').addEventListener('keydown', (e) => {
    if (e.key === 'Tab' && !e.shiftKey) {
        e.preventDefault();
        document.getElementById('register-btn').focus();
    }
});

</script>


<!-- Modal Conditions d'utilisation -->
<div class="modal-overlay" id="terms-modal">
    <div class="modal">
        <div class="modal-header">
            <h2 class="modal-title"><i class="fas fa-file-contract"></i> Conditions d'utilisation</h2>
            <button class="modal-close" id="modal-close"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
            <p><strong>Dernière mise à jour :</strong> Janvier 2025</p>
            
            <h3>1. Présentation du service</h3>
            <p>TypixClin est une plateforme gratuite d'aide à la rédaction médicale destinée aux étudiants en médecine. Elle propose des outils de génération de comptes-rendus d'examens cliniques, d'interprétation d'ECG, de gaz du sang et autres ressources pédagogiques.</p>
            
            <h3>2. Avertissement médical</h3>
            <p>TypixClin est un outil <strong>pédagogique uniquement</strong>. Les informations générées ne constituent en aucun cas un avis médical et ne doivent pas être utilisées pour prendre des décisions cliniques réelles. L'utilisateur reste seul responsable de la vérification des informations.</p>
            
            <h3>3. Compte utilisateur</h3>
            <p>En créant un compte, vous vous engagez à :</p>
            <ul>
                <li>Fournir des informations exactes</li>
                <li>Maintenir la confidentialité de vos identifiants</li>
                <li>Ne pas partager votre compte avec des tiers</li>
            </ul>
            
            <h3>4. Utilisation acceptable</h3>
            <p>Vous vous engagez à utiliser TypixClin uniquement à des fins d'apprentissage et de formation médicale. Il est interdit de :</p>
            <ul>
                <li>Tenter de contourner les mesures de sécurité</li>
                <li>Utiliser le service de manière abusive ou frauduleuse</li>
            </ul>
            
            <h3>5. Propriété intellectuelle</h3>
            <p>Le contenu, le design et le code de TypixClin sont la propriété de Jean ZENNARO. Toute reproduction non autorisée est interdite.</p>
            
            <h3>6. Données personnelles</h3>
            <p>Nous collectons uniquement les données nécessaires au fonctionnement du service (email, nom). Vos données ne sont jamais vendues à des tiers. Vous pouvez demander la suppression de votre compte à tout moment.</p>
            
            <h3>7. Limitation de responsabilité</h3>
            <p>TypixClin est fourni "tel quel". Nous ne garantissons pas l'exactitude des informations générées et déclinons toute responsabilité en cas d'utilisation inappropriée.</p>
            
            <h3>8. Contact</h3>
            <p>Pour toute question, contactez-nous via le formulaire de feedback sur le site.</p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="modal-cancel">Fermer</button>
            <button class="btn btn-primary" id="modal-accept"><i class="fas fa-check"></i> J'accepte</button>
        </div>
    </div>
</div>


</body>
</html>